<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="adminOrder">

	<!-- 전체 주문 리스트 -->
	<select id="allOrderList" resultType="hashmap">
		<![CDATA[
			SELECT A.ORDER_NUMBER, A.MEMBER_NUMBER, A.GOODS_NUMBER, A.ORDER_CODE, A.ORDER_AMOUNT, A.ORDER_DATE,
				A.ORDER_DELIVERY_STATE, A.ORDER_TOTAL_PRICE, A.ORDER_PAY_STATE, A.GOODS_KIND_NUMBER, A.ORDER_STATE,
				C.BUYER_NAME, C.RECEIVER_NAME, C.BUYER_NUMBER,
				C.BUYER_EMAIL, C.RECEIVER_ZIPCODE, C.RECEIVER_ADDRESS1, C.RECEIVER_ADDRESS2, C.RECEIVER_NUMBER,
				C.DELIVERY_MESSAGE, D.MEMBER_ID, D.MEMBER_NAME, E.GOODS_THUMBNAIL, E.GOODS_NAME, F.GOODS_OPTION1, F.GOODS_OPTION2, E.GOODS_BRNAME
			FROM ORDERLIST A, DELIVERY C, MEMBER D, GOODS E, GOODS_KIND F 
			WHERE A.ORDER_CODE = C.ORDER_CODE 
			AND A.MEMBER_NUMBER = D.MEMBER_NUMBER(+)
			AND E.GOODS_NUMBER = A.GOODS_NUMBER 
			AND F.GOODS_KIND_NUMBER = A.GOODS_KIND_NUMBER
			ORDER BY ORDER_DATE DESC, ORDER_NUMBER DESC
		]]>
	</select>
	
	<!-- 주문내역 상세보기 -->
	<select id="orderDetail" resultType="hashmap">
		<![CDATA[
			SELECT A.ORDER_NUMBER, A.MEMBER_NUMBER, A.GOODS_NUMBER, A.ORDER_CODE, A.ORDER_AMOUNT, A.ORDER_DATE,
				A.ORDER_DELIVERY_STATE, A.ORDER_TOTAL_PRICE, A.ORDER_PAY_STATE, A.GOODS_KIND_NUMBER, A.ORDER_STATE,
				C.BUYER_NAME, C.BUYER_ZIPCODE, C.BUYER_ADDRESS1, C.BUYER_ADDRESS2, C.BUYER_NUMBER, C.RECEIVER_NAME, C.BUYER_EMAIL,
				C.RECEIVER_ZIPCODE, C.RECEIVER_ADDRESS1, C.RECEIVER_ADDRESS2, C.RECEIVER_NUMBER, C.DELIVERY_MESSAGE,
				D.MEMBER_ID, D.MEMBER_NAME, 
				E.GOODS_THUMBNAIL, E.GOODS_NAME, E.GOODS_CATEGORY1, E.GOODS_CATEGORY2,
				F.GOODS_OPTION1, F.GOODS_OPTION2, 
				P.POINT_POINT, E.GOODS_BRNAME
			FROM ORDERLIST A, DELIVERY C, MEMBER D, GOODS E, GOODS_KIND F, POINT P 
			WHERE A.ORDER_CODE = C.ORDER_CODE 
			AND A.MEMBER_NUMBER = D.MEMBER_NUMBER(+)
			AND E.GOODS_NUMBER = A.GOODS_NUMBER 
			AND F.GOODS_KIND_NUMBER = A.GOODS_KIND_NUMBER 
			AND A.ORDER_CODE = #{ORDER_CODE} 
			AND P.ORDER_CODE(+) = A.ORDER_CODE
			ORDER BY ORDER_DATE DESC, ORDER_NUMBER DESC
		]]>
	</select>
	
	<!-- 결제 상태 변경 -->
	<update id="updateGoodsPayState" parameterType="hashmap">
		<![CDATA[
			UPDATE ORDERLIST 
			SET ORDER_PAY_STATE = #{ORDER_PAY_STATE} 
			WHERE ORDER_CODE = #{ORDER_CODE}
		]]>
	</update>
	
	<!-- 상품 구매확정/주문취소/교환,반품 상태변경 -->
	<update id="updateGoodsState" parameterType="hashmap">
		<![CDATA[
			UPDATE ORDERLIST
			SET ORDER_STATE = #{ORDER_STATE}
			WHERE ORDER_CODE = #{ORDER_CODE}
		]]>
	</update>
	
	<!-- 배송 상태 변경 -->
	<update id="updateDeliveryState" parameterType="hashmap">
		<![CDATA[
			UPDATE ORDERLIST 
			SET ORDER_DELIVERY_STATE = #{ORDER_DELIVERY_STATE} 
			WHERE ORDER_CODE = #{ORDER_CODE}
		]]>
	</update>
	
	<!-- 주문 삭제 -->
	<delete id="orderDelete" parameterType="hashmap">
		<![CDATA[
			DELETE DELIVERY 
			WHERE ORDER_CODE = #{ORDER_CODE}
		]]>
	</delete>
	
	<!-- 결제상태로 검색 -->
	<select id="adminOrderSearch0" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
			SELECT A.ORDER_NUMBER, A.MEMBER_NUMBER, A.GOODS_NUMBER, A.ORDER_CODE, A.ORDER_AMOUNT, A.ORDER_DATE,
				A.ORDER_DELIVERY_STATE, A.ORDER_TOTAL_PRICE, A.ORDER_PAY_STATE, A.GOODS_KIND_NUMBER, A.ORDER_STATE,
				C.BUYER_NAME, C.RECEIVER_NAME, C.BUYER_NUMBER,
				C.BUYER_EMAIL, C.RECEIVER_ZIPCODE, C.RECEIVER_ADDRESS1, C.RECEIVER_ADDRESS2, C.RECEIVER_NUMBER,
				C.DELIVERY_MESSAGE, 
				D.MEMBER_ID, D.MEMBER_NAME, 
				E.GOODS_THUMBNAIL, E.GOODS_NAME, 
				F.GOODS_OPTION1, F.GOODS_OPTION2
			FROM ORDERLIST A, DELIVERY C, MEMBER D, GOODS E, GOODS_KIND F 
			WHERE A.ORDER_CODE = C.ORDER_CODE 
			AND A.MEMBER_NUMBER = D.MEMBER_NUMBER(+)
			AND E.GOODS_NUMBER = A.GOODS_NUMBER 
			AND F.GOODS_KIND_NUMBER = A.GOODS_KIND_NUMBER 
			AND A.ORDER_PAY_STATE = #{isSearch} 
			AND A.ORDER_STATE = '주문진행중'
			ORDER BY ORDER_DATE DESC, ORDER_NUMBER DESC
		]]>
	</select>
	
	<!-- 주문상태로 검색 -->
	<select id="adminOrderSearch1" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
			SELECT A.ORDER_NUMBER, A.MEMBER_NUMBER, A.GOODS_NUMBER, A.ORDER_CODE, A.ORDER_AMOUNT, A.ORDER_DATE,
				A.ORDER_DELIVERY_STATE, A.ORDER_TOTAL_PRICE, A.ORDER_PAY_STATE, A.GOODS_KIND_NUMBER, A.ORDER_STATE,
				C.BUYER_NAME, C.RECEIVER_NAME, C.BUYER_NUMBER, C.BUYER_EMAIL,
				C.RECEIVER_ZIPCODE, C.RECEIVER_ADDRESS1, C.RECEIVER_ADDRESS2, C.RECEIVER_NUMBER, C.DELIVERY_MESSAGE, 
				D.MEMBER_ID, D.MEMBER_NAME, 
				E.GOODS_THUMBNAIL, E.GOODS_NAME, 
				F.GOODS_OPTION1, F.GOODS_OPTION2
			FROM ORDERLIST A, DELIVERY C, MEMBER D, GOODS E, GOODS_KIND F 
			WHERE A.ORDER_CODE = C.ORDER_CODE 
			AND A.MEMBER_NUMBER = D.MEMBER_NUMBER(+)
			AND E.GOODS_NUMBER = A.GOODS_NUMBER 
			AND F.GOODS_KIND_NUMBER = A.GOODS_KIND_NUMBER 
			AND A.ORDER_STATE = #{isSearch}
			ORDER BY ORDER_DATE DESC, ORDER_NUMBER DESC
		]]>
	</select>
	
	<!-- 배송상태로 검색 -->
	<select id="adminOrderSearch2" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
			SELECT A.ORDER_NUMBER, A.MEMBER_NUMBER, A.GOODS_NUMBER, A.ORDER_CODE, A.ORDER_AMOUNT, A.ORDER_DATE,
				A.ORDER_DELIVERY_STATE, A.ORDER_TOTAL_PRICE, A.ORDER_PAY_STATE, A.GOODS_KIND_NUMBER, A.ORDER_STATE,
				C.BUYER_NAME, C.RECEIVER_NAME, C.BUYER_NUMBER,
				C.BUYER_EMAIL, C.RECEIVER_ZIPCODE, C.RECEIVER_ADDRESS1, C.RECEIVER_ADDRESS2, C.RECEIVER_NUMBER,
				C.DELIVERY_MESSAGE, 
				D.MEMBER_ID, D.MEMBER_NAME, 
				E.GOODS_THUMBNAIL, E.GOODS_NAME,
				F.GOODS_OPTION1, F.GOODS_OPTION2
			FROM ORDERLIST A, DELIVERY C, MEMBER D, GOODS E, GOODS_KIND F 
			WHERE A.ORDER_CODE = C.ORDER_CODE 
			AND A.MEMBER_NUMBER = D.MEMBER_NUMBER(+)
			AND E.GOODS_NUMBER = A.GOODS_NUMBER 
			AND F.GOODS_KIND_NUMBER = A.GOODS_KIND_NUMBER 
			AND A.ORDER_DELIVERY_STATE = #{isSearch}
			ORDER BY ORDER_DATE DESC, ORDER_NUMBER DESC
		]]>
	</select>
	
	<!-- 주문코드로 검색 -->
	<select id="adminOrderSearch3" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
			SELECT A.ORDER_NUMBER, A.MEMBER_NUMBER, A.GOODS_NUMBER, A.ORDER_CODE, A.ORDER_AMOUNT, A.ORDER_DATE,
				A.ORDER_DELIVERY_STATE, A.ORDER_TOTAL_PRICE, A.ORDER_PAY_STATE, A.GOODS_KIND_NUMBER, A.ORDER_STATE,
				C.BUYER_NAME, C.RECEIVER_NAME, C.BUYER_NUMBER, C.BUYER_EMAIL, C.RECEIVER_ZIPCODE, 
				C.RECEIVER_ADDRESS1, C.RECEIVER_ADDRESS2, C.RECEIVER_NUMBER, C.DELIVERY_MESSAGE, 
				D.MEMBER_ID, D.MEMBER_NAME, 
				E.GOODS_THUMBNAIL, E.GOODS_NAME,
				F.GOODS_OPTION1, F.GOODS_OPTION2
			FROM ORDERLIST A, DELIVERY C, MEMBER D, GOODS E, GOODS_KIND F 
			WHERE A.ORDER_CODE = C.ORDER_CODE 
			AND A.MEMBER_NUMBER = D.MEMBER_NUMBER(+)
			AND E.GOODS_NUMBER = A.GOODS_NUMBER 
			AND F.GOODS_KIND_NUMBER = A.GOODS_KIND_NUMBER 
			AND A.ORDER_CODE LIKE '%'||#{isSearch}||'%'
			ORDER BY ORDER_DATE DESC, ORDER_NUMBER DESC
		]]>
	</select>
	
	<!-- 상품 이름으로 검색 -->
	<select id="adminOrderSearch4" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
			SELECT A.ORDER_NUMBER, A.MEMBER_NUMBER, A.GOODS_NUMBER, A.ORDER_CODE, A.ORDER_AMOUNT, A.ORDER_DATE,
				A.ORDER_DELIVERY_STATE, A.ORDER_TOTAL_PRICE, A.ORDER_PAY_STATE, A.GOODS_KIND_NUMBER, A.ORDER_STATE,
				C.BUYER_NAME, C.RECEIVER_NAME, C.BUYER_NUMBER, C.BUYER_EMAIL, C.RECEIVER_ZIPCODE, 
				C.RECEIVER_ADDRESS1, C.RECEIVER_ADDRESS2, C.RECEIVER_NUMBER, C.DELIVERY_MESSAGE, 
				D.MEMBER_ID, D.MEMBER_NAME, 
				E.GOODS_THUMBNAIL, E.GOODS_NAME,
				F.GOODS_OPTION1, F.GOODS_OPTION2
			FROM ORDERLIST A, DELIVERY C, MEMBER D, GOODS E, GOODS_KIND F 
			WHERE A.ORDER_CODE = C.ORDER_CODE 
			AND A.MEMBER_NUMBER = D.MEMBER_NUMBER(+)
			AND E.GOODS_NUMBER = A.GOODS_NUMBER 
			AND F.GOODS_KIND_NUMBER = A.GOODS_KIND_NUMBER 	
			AND E.GOODS_NAME LIKE '%'||#{isSearch}||'%'
			ORDER BY ORDER_DATE DESC, ORDER_NUMBER DESC
		]]>
	</select>
	
	<!-- 회원 ID로 검색 -->
	<select id="adminOrderSearch5" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
			SELECT A.ORDER_NUMBER, A.MEMBER_NUMBER, A.GOODS_NUMBER, A.ORDER_CODE, A.ORDER_AMOUNT, A.ORDER_DATE,
				A.ORDER_DELIVERY_STATE, A.ORDER_TOTAL_PRICE, A.ORDER_PAY_STATE, A.GOODS_KIND_NUMBER, A.ORDER_STATE,
				C.BUYER_NAME, C.RECEIVER_NAME, C.BUYER_NUMBER, C.BUYER_EMAIL, 
				C.RECEIVER_ZIPCODE, C.RECEIVER_ADDRESS1, C.RECEIVER_ADDRESS2, C.RECEIVER_NUMBER, C.DELIVERY_MESSAGE, 
				D.MEMBER_ID, D.MEMBER_NAME, 
				E.GOODS_THUMBNAIL, E.GOODS_NAME,
				F.GOODS_OPTION1, F.GOODS_OPTION2
			FROM ORDERLIST A, DELIVERY C, MEMBER D, GOODS E, GOODS_KIND F 
			WHERE A.ORDER_CODE = C.ORDER_CODE 
			AND A.MEMBER_NUMBER = D.MEMBER_NUMBER(+)
			AND E.GOODS_NUMBER = A.GOODS_NUMBER 
			AND F.GOODS_KIND_NUMBER = A.GOODS_KIND_NUMBER 
			AND D.MEMBER_ID LIKE '%'||#{isSearch}||'%'
			ORDER BY ORDER_DATE DESC, ORDER_NUMBER DESC
		]]>
	</select>
</mapper>