<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="adminOrderCancel">

	<!-- 해당 주문 코드에 대한 취소 유무 확인 -->
	<select id="confirmCancel" resultType="hashmap" parameterType="hashmap">
		<![CDATA[
			SELECT CANCEL_CONTENT, CANCEL_REGDATE 
			FROM CANCEL 
			WHERE ORDER_CODE = #{ORDER_CODE}
		]]>
	</select>
	
	<!-- 주문 취소 목록 -->
	<select id="allCancelList" resultType="hashmap" parameterType="hashmap">
		<![CDATA[
			SELECT A.ORDER_NUMBER, A.MEMBER_NUMBER, A.GOODS_NUMBER, A.ORDER_CODE, A.ORDER_AMOUNT, A.ORDER_DATE,
				A.ORDER_DELIVERY_STATE, A.ORDER_TOTAL_PRICE, A.ORDER_PAY_STATE, A.GOODS_KIND_NUMBER, A.ORDER_STATE,
				C.BUYER_NAME, C.RECEIVER_NAME, C.BUYER_NUMBER, C.BUYER_EMAIL, C.RECEIVER_ZIPCODE, 
				C.RECEIVER_ADDRESS1, C.RECEIVER_ADDRESS2, C.RECEIVER_NUMBER, C.DELIVERY_MESSAGE, 
				D.MEMBER_ID, D.MEMBER_NAME, 
				E.GOODS_THUMBNAIL, E.GOODS_NAME,
				F.GOODS_OPTION1, F.GOODS_OPTION2, E.GOODS_BRNAME
			FROM ORDERLIST A, DELIVERY C, MEMBER D, GOODS E, GOODS_KIND F
			WHERE A.ORDER_CODE = C.ORDER_CODE 
			AND A.MEMBER_NUMBER = D.MEMBER_NUMBER(+)
			AND E.GOODS_NUMBER = A.GOODS_NUMBER 
			AND F.GOODS_KIND_NUMBER = A.GOODS_KIND_NUMBER 
			AND A.ORDER_STATE IN ('주문취소','취소완료')
			ORDER BY ORDER_NUMBER DESC
		]]>
	</select>
	
	<!-- 주문 반품/교환 목록 -->
	<select id="allExchangeList" resultType="hashmap" parameterType="hashmap">
		<![CDATA[
			SELECT A.ORDER_NUMBER, A.MEMBER_NUMBER, A.GOODS_NUMBER, A.ORDER_CODE, A.ORDER_AMOUNT, A.ORDER_DATE,
				A.ORDER_DELIVERY_STATE, A.ORDER_TOTAL_PRICE, A.ORDER_PAY_STATE, A.GOODS_KIND_NUMBER, A.ORDER_STATE,
				C.BUYER_NAME, C.RECEIVER_NAME, C.BUYER_NUMBER,
				C.BUYER_EMAIL, C.RECEIVER_ZIPCODE, C.RECEIVER_ADDRESS1, C.RECEIVER_ADDRESS2, C.RECEIVER_NUMBER,
				C.DELIVERY_MESSAGE, 
				D.MEMBER_ID, D.MEMBER_NAME, 
				E.GOODS_THUMBNAIL, E.GOODS_NAME, E.GOODS_BRNAME,
				F.GOODS_OPTION1, F.GOODS_OPTION2, 
				G.CANCEL_NUMBER, G.CANCEL_CONTENT, G.CANCEL_REGDATE
			FROM ORDERLIST A, DELIVERY C, MEMBER D, GOODS E, GOODS_KIND F, CANCEL G 
			WHERE A.ORDER_CODE = C.ORDER_CODE 
			AND A.MEMBER_NUMBER = D.MEMBER_NUMBER(+)
			AND E.GOODS_NUMBER = A.GOODS_NUMBER 
			AND F.GOODS_KIND_NUMBER = A.GOODS_KIND_NUMBER 
			AND A.ORDER_STATE IN ('교환신청', '반품신청','교환완료','반품완료') 
			AND A.ORDER_CODE = G.ORDER_CODE
			ORDER BY ORDER_DATE DESC, ORDER_NUMBER DESC
		]]>
	</select>
	
	
	<!-- 주문 취소 삭제 -->
	<delete id="cancelDelete" parameterType="hashmap">
		<![CDATA[
			DELETE CANCEL 
			WHERE ORDER_CODE = #{ORDER_CODE}
		]]>
	</delete>
	
	<!-- 배송 상태로 주문 취소 목록 검색 -->
	<select id="allCancelSearch1" resultType="hashmap" parameterType="hashmap">
		<![CDATA[
			SELECT A.ORDER_NUMBER, A.MEMBER_NUMBER, A.GOODS_NUMBER, A.ORDER_CODE, A.ORDER_AMOUNT, A.ORDER_DATE,
				A.ORDER_DELIVERY_STATE, A.ORDER_TOTAL_PRICE, A.ORDER_PAY_STATE, A.GOODS_KIND_NUMBER, A.ORDER_STATE,
				C.BUYER_NAME, C.RECEIVER_NAME, C.BUYER_NUMBER,
				C.BUYER_EMAIL, C.RECEIVER_ZIPCODE, C.RECEIVER_ADDRESS1, C.RECEIVER_ADDRESS2, C.RECEIVER_NUMBER,
				C.DELIVERY_MESSAGE, 
				D.MEMBER_ID, D.MEMBER_NAME, 
				E.GOODS_THUMBNAIL, E.GOODS_NAME,
				F.GOODS_OPTION1, F.GOODS_OPTION2, E.GOODS_BRNAME
			FROM ORDERLIST A, DELIVERY C, MEMBER D, GOODS E, GOODS_KIND F 
			WHERE A.ORDER_CODE = C.ORDER_CODE 
			AND A.MEMBER_NUMBER = D.MEMBER_NUMBER(+)
			AND E.GOODS_NUMBER = A.GOODS_NUMBER 
			AND F.GOODS_KIND_NUMBER = A.GOODS_KIND_NUMBER 
			AND A.ORDER_STATE = #{isSearch}
			ORDER BY ORDER_NUMBER DESC
		]]>
	</select>
	
	<!-- 주문 코드로 주문 취소 목록 검색 -->
	<select id="allCancelSearch2" resultType="hashmap" parameterType="hashmap">
		<![CDATA[
			SELECT A.ORDER_NUMBER, A.MEMBER_NUMBER, A.GOODS_NUMBER, A.ORDER_CODE, A.ORDER_AMOUNT, A.ORDER_DATE,
				A.ORDER_DELIVERY_STATE, A.ORDER_TOTAL_PRICE, A.ORDER_PAY_STATE, A.GOODS_KIND_NUMBER, A.ORDER_STATE,
				C.BUYER_NAME, C.RECEIVER_NAME, C.BUYER_NUMBER,
				C.BUYER_EMAIL, C.RECEIVER_ZIPCODE, C.RECEIVER_ADDRESS1, C.RECEIVER_ADDRESS2, C.RECEIVER_NUMBER,
				C.DELIVERY_MESSAGE, 
				D.MEMBER_ID, D.MEMBER_NAME, 
				E.GOODS_THUMBNAIL, E.GOODS_NAME,
				F.GOODS_OPTION1, F.GOODS_OPTION2, E.GOODS_BRNAME
			FROM ORDERLIST A, DELIVERY C, MEMBER D, GOODS E, GOODS_KIND F 
			WHERE A.ORDER_CODE = C.ORDER_CODE 
			AND A.MEMBER_NUMBER = D.MEMBER_NUMBER(+)
			AND E.GOODS_NUMBER = A.GOODS_NUMBER 
			AND F.GOODS_KIND_NUMBER = A.GOODS_KIND_NUMBER 
			AND A.ORDER_STATE IN('취소완료','주문취소')
	      		AND A.ORDER_CODE LIKE '%'||#{isSearch}||'%'
			ORDER BY ORDER_NUMBER DESC
		]]>
	</select>
	
	
	<!-- 상품 이름으로 주문 취소 목록 검색 -->
	<select id="allCancelSearch3" resultType="hashmap" parameterType="hashmap">
		<![CDATA[
			SELECT A.ORDER_NUMBER, A.MEMBER_NUMBER, A.GOODS_NUMBER, A.ORDER_CODE, A.ORDER_AMOUNT, A.ORDER_DATE,
				A.ORDER_DELIVERY_STATE, A.ORDER_TOTAL_PRICE, A.ORDER_PAY_STATE, A.GOODS_KIND_NUMBER, A.ORDER_STATE,
				C.BUYER_NAME, C.RECEIVER_NAME, C.BUYER_NUMBER,
				C.BUYER_EMAIL, C.RECEIVER_ZIPCODE, C.RECEIVER_ADDRESS1, C.RECEIVER_ADDRESS2, C.RECEIVER_NUMBER,
				C.DELIVERY_MESSAGE, 
				D.MEMBER_ID, D.MEMBER_NAME, 
				E.GOODS_THUMBNAIL, E.GOODS_NAME,
				F.GOODS_OPTION1, F.GOODS_OPTION2, E.GOODS_BRNAME
			FROM ORDERLIST A, DELIVERY C, MEMBER D, GOODS E, GOODS_KIND F 
			WHERE A.ORDER_CODE = C.ORDER_CODE 
			AND A.MEMBER_NUMBER = D.MEMBER_NUMBER(+)
			AND E.GOODS_NUMBER = A.GOODS_NUMBER 
			AND F.GOODS_KIND_NUMBER = A.GOODS_KIND_NUMBER 
			AND A.ORDER_STATE IN('취소완료','주문취소')
			AND E.GOODS_NAME LIKE '%'||#{isSearch}||'%'
			ORDER BY ORDER_NUMBER DESC
		]]>
	</select>
	
	<!-- 회원 아이디로 주문 취소 목록 검색 -->
	<select id="allCancelSearch4" resultType="hashmap" parameterType="hashmap">
		<![CDATA[
			SELECT A.ORDER_NUMBER, A.MEMBER_NUMBER, A.GOODS_NUMBER, A.ORDER_CODE, A.ORDER_AMOUNT, A.ORDER_DATE,
				A.ORDER_DELIVERY_STATE, A.ORDER_TOTAL_PRICE, A.ORDER_PAY_STATE, A.GOODS_KIND_NUMBER, A.ORDER_STATE,
				C.BUYER_NAME, C.RECEIVER_NAME, C.BUYER_NUMBER,
				C.BUYER_EMAIL, C.RECEIVER_ZIPCODE, C.RECEIVER_ADDRESS1, C.RECEIVER_ADDRESS2, C.RECEIVER_NUMBER,
				C.DELIVERY_MESSAGE, 
				D.MEMBER_ID, D.MEMBER_NAME, 
				E.GOODS_THUMBNAIL, E.GOODS_NAME,
				F.GOODS_OPTION1, F.GOODS_OPTION2, E.GOODS_BRNAME
			FROM ORDERLIST A, DELIVERY C, MEMBER D, GOODS E, GOODS_KIND F 
			WHERE A.ORDER_CODE = C.ORDER_CODE 
			AND A.MEMBER_NUMBER = D.MEMBER_NUMBER(+)
			AND E.GOODS_NUMBER = A.GOODS_NUMBER 
			AND F.GOODS_KIND_NUMBER = A.GOODS_KIND_NUMBER 
			AND A.ORDER_STATE IN('취소완료','주문취소')
			AND D.MEMBER_ID LIKE '%'||#{isSearch}||'%'
			ORDER BY ORDER_NUMBER DESC
		]]>
	</select>
	
	<!-- 주문 상태로 교환/반품 목록 검색 -->
	<select id="allExchangeSearch1" resultType="hashmap" parameterType="hashmap">
		<![CDATA[
			SELECT A.ORDER_NUMBER, A.MEMBER_NUMBER, A.GOODS_NUMBER, A.ORDER_CODE, A.ORDER_AMOUNT, A.ORDER_DATE,
				A.ORDER_DELIVERY_STATE, A.ORDER_TOTAL_PRICE, A.ORDER_PAY_STATE, A.GOODS_KIND_NUMBER, A.ORDER_STATE,
				C.BUYER_NAME, C.RECEIVER_NAME, C.BUYER_NUMBER,
				C.BUYER_EMAIL, C.RECEIVER_ZIPCODE, C.RECEIVER_ADDRESS1, C.RECEIVER_ADDRESS2, C.RECEIVER_NUMBER,
				C.DELIVERY_MESSAGE, 
				D.MEMBER_ID, D.MEMBER_NAME, 
				E.GOODS_THUMBNAIL, E.GOODS_NAME,
				F.GOODS_OPTION1, F.GOODS_OPTION2,
				G.CANCEL_NUMBER, G.CANCEL_CONTENT, G.CANCEL_REGDATE, E.GOODS_BRNAME
			FROM ORDERLIST A, DELIVERY C, MEMBER D, GOODS E, GOODS_KIND F, CANCEL G 
			WHERE A.ORDER_CODE = C.ORDER_CODE 
			AND A.MEMBER_NUMBER = D.MEMBER_NUMBER(+)
			AND E.GOODS_NUMBER = A.GOODS_NUMBER 
			AND F.GOODS_KIND_NUMBER = A.GOODS_KIND_NUMBER 
			AND A.ORDER_STATE IN ('교환신청', '반품신청','교환완료','반품완료') 
			AND A.ORDER_CODE = G.ORDER_CODE
			AND A.ORDER_STATE = #{isSearch}
			ORDER BY ORDER_DATE DESC, ORDER_NUMBER DESC
		]]>
	</select>
	
	<!-- 배송 상태로 교환/반품 목록 검색 -->
	<select id="allExchangeSearch2" resultType="hashmap" parameterType="hashmap">
		<![CDATA[
			SELECT A.ORDER_NUMBER, A.MEMBER_NUMBER, A.GOODS_NUMBER, A.ORDER_CODE, A.ORDER_AMOUNT, A.ORDER_DATE,
				A.ORDER_DELIVERY_STATE, A.ORDER_TOTAL_PRICE, A.ORDER_PAY_STATE, A.GOODS_KIND_NUMBER, A.ORDER_STATE,
				C.BUYER_NAME, C.RECEIVER_NAME, C.BUYER_NUMBER,
				C.BUYER_EMAIL, C.RECEIVER_ZIPCODE, C.RECEIVER_ADDRESS1, C.RECEIVER_ADDRESS2, C.RECEIVER_NUMBER,
				C.DELIVERY_MESSAGE, 
				D.MEMBER_ID, D.MEMBER_NAME, 
				E.GOODS_THUMBNAIL, E.GOODS_NAME,
				F.GOODS_OPTION1, F.GOODS_OPTION2,
				G.CANCEL_NUMBER, G.CANCEL_CONTENT, G.CANCEL_REGDATE, E.GOODS_BRNAME
			FROM ORDERLIST A, DELIVERY C, MEMBER D, GOODS E, GOODS_KIND F, CANCEL G 
			WHERE A.ORDER_CODE = C.ORDER_CODE 
			AND A.MEMBER_NUMBER = D.MEMBER_NUMBER(+)
			AND E.GOODS_NUMBER = A.GOODS_NUMBER 
			AND F.GOODS_KIND_NUMBER = A.GOODS_KIND_NUMBER 
			AND A.ORDER_STATE IN ('교환신청', '반품신청','교환완료','반품완료') 
			AND A.ORDER_CODE = G.ORDER_CODE
			AND A.ORDER_DELIVERY_STATE = #{isSearch}
			ORDER BY ORDER_DATE DESC, ORDER_NUMBER DESC
		]]>
	</select>
	
	<!-- 주문 코드로 교환/반품 목록 검색 -->
	<select id="allExchangeSearch3" resultType="hashmap" parameterType="hashmap">
		<![CDATA[
			SELECT A.ORDER_NUMBER, A.MEMBER_NUMBER, A.GOODS_NUMBER, A.ORDER_CODE, A.ORDER_AMOUNT, A.ORDER_DATE,
				A.ORDER_DELIVERY_STATE, A.ORDER_TOTAL_PRICE, A.ORDER_PAY_STATE, A.GOODS_KIND_NUMBER, A.ORDER_STATE,
				C.BUYER_NAME, C.RECEIVER_NAME, C.BUYER_NUMBER,
				C.BUYER_EMAIL, C.RECEIVER_ZIPCODE, C.RECEIVER_ADDRESS1, C.RECEIVER_ADDRESS2, C.RECEIVER_NUMBER,
				C.DELIVERY_MESSAGE, 
				D.MEMBER_ID, D.MEMBER_NAME, 
				E.GOODS_THUMBNAIL, E.GOODS_NAME,
				F.GOODS_OPTION1, F.GOODS_OPTION2,
				G.CANCEL_NUMBER, G.CANCEL_CONTENT, G.CANCEL_REGDATE, E.GOODS_BRNAME
			FROM ORDERLIST A, DELIVERY C, MEMBER D, GOODS E, GOODS_KIND F, CANCEL G 
			WHERE A.ORDER_CODE = C.ORDER_CODE 
			AND A.MEMBER_NUMBER = D.MEMBER_NUMBER(+)
			AND E.GOODS_NUMBER = A.GOODS_NUMBER 
			AND F.GOODS_KIND_NUMBER = A.GOODS_KIND_NUMBER 
			AND A.ORDER_STATE IN ('교환신청', '반품신청','교환완료','반품완료') 
			AND A.ORDER_CODE = G.ORDER_CODE
			AND A.ORDER_CODE LIKE '%'||#{isSearch}||'%'
			ORDER BY ORDER_DATE DESC, ORDER_NUMBER DESC
		]]>
	</select>
	
	<!-- 상품 이름으로 교환/반품 목록 검색 -->
	<select id="allExchangeSearch4" resultType="hashmap" parameterType="hashmap">
		<![CDATA[
			SELECT A.ORDER_NUMBER, A.MEMBER_NUMBER, A.GOODS_NUMBER, A.ORDER_CODE, A.ORDER_AMOUNT, A.ORDER_DATE,
				A.ORDER_DELIVERY_STATE, A.ORDER_TOTAL_PRICE, A.ORDER_PAY_STATE, A.GOODS_KIND_NUMBER, A.ORDER_STATE,
				C.BUYER_NAME, C.RECEIVER_NAME, C.BUYER_NUMBER,
				C.BUYER_EMAIL, C.RECEIVER_ZIPCODE, C.RECEIVER_ADDRESS1, C.RECEIVER_ADDRESS2, C.RECEIVER_NUMBER,
				C.DELIVERY_MESSAGE, 
				D.MEMBER_ID, D.MEMBER_NAME, 
				E.GOODS_THUMBNAIL, E.GOODS_NAME,
				F.GOODS_OPTION1, F.GOODS_OPTION2,
				G.CANCEL_NUMBER, G.CANCEL_CONTENT, G.CANCEL_REGDATE, E.GOODS_BRNAME
			FROM ORDERLIST A, DELIVERY C, MEMBER D, GOODS E, GOODS_KIND F, CANCEL G 
			WHERE A.ORDER_CODE = C.ORDER_CODE 
			AND A.MEMBER_NUMBER = D.MEMBER_NUMBER(+)
			AND E.GOODS_NUMBER = A.GOODS_NUMBER 
			AND F.GOODS_KIND_NUMBER = A.GOODS_KIND_NUMBER 
			AND A.ORDER_STATE IN ('교환신청', '반품신청','교환완료','반품완료') 
			AND A.ORDER_CODE = G.ORDER_CODE
			AND E.GOODS_NAME LIKE '%'||#{isSearch}||'%'
			ORDER BY ORDER_DATE DESC, ORDER_NUMBER DESC
		]]>
	</select>
	
	<!-- 회원 아이디로 교환/반품 검색 -->
	<select id="allExchangeSearch5" resultType="hashmap" parameterType="hashmap">
		<![CDATA[
			SELECT A.ORDER_NUMBER, A.MEMBER_NUMBER, A.GOODS_NUMBER, A.ORDER_CODE, A.ORDER_AMOUNT, A.ORDER_DATE,
				A.ORDER_DELIVERY_STATE, A.ORDER_TOTAL_PRICE, A.ORDER_PAY_STATE, A.GOODS_KIND_NUMBER, A.ORDER_STATE,
				C.BUYER_NAME, C.RECEIVER_NAME, C.BUYER_NUMBER,
				C.BUYER_EMAIL, C.RECEIVER_ZIPCODE, C.RECEIVER_ADDRESS1, C.RECEIVER_ADDRESS2, C.RECEIVER_NUMBER,
				C.DELIVERY_MESSAGE, 
				D.MEMBER_ID, D.MEMBER_NAME, 
				E.GOODS_THUMBNAIL, E.GOODS_NAME,
				F.GOODS_OPTION1, F.GOODS_OPTION2,
				G.CANCEL_NUMBER, G.CANCEL_CONTENT, G.CANCEL_REGDATE, E.GOODS_BRNAME
			FROM ORDERLIST A, DELIVERY C, MEMBER D, GOODS E, GOODS_KIND F, CANCEL G 
			WHERE A.ORDER_CODE = C.ORDER_CODE 
			AND A.MEMBER_NUMBER = D.MEMBER_NUMBER(+)
			AND E.GOODS_NUMBER = A.GOODS_NUMBER 
			AND F.GOODS_KIND_NUMBER = A.GOODS_KIND_NUMBER 
			AND A.ORDER_STATE IN ('교환신청', '반품신청','교환완료','반품완료') 
			AND A.ORDER_CODE = G.ORDER_CODE
			AND D.MEMBER_ID LIKE '%'||#{isSearch}||'%'
			ORDER BY ORDER_DATE DESC, ORDER_NUMBER DESC
		]]>
	</select>
</mapper>